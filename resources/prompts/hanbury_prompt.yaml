#Define variable configuration
# Model config
#model: "qwen2.5"
crop: False
ocr_extraction_model: "qwen2.5"#null
output_save_file_name: "hanbury"
output_save_path: "outputs/hanbury_with_extract/"    # Where to save the output
# has_columns: False
# double_pages: False
# define to inherit any missing prompts from the default prompt
inherit_default: False
# Path to default file if inheriting from another custom prompt
default_file: null
# Any divisions in the catalogue
divisions: ["Dicotyledones", "Monocotyledones"]
# System defines the system prompt to the model
system:
  # Setup defines the model setup prompt. This lets the model know what area of knowledge to focus on for this task
  setup: >
    You are an expert in botanical catalogues
  # context defines the context of the task. This includes the input to the model and the description of said input
  # instructions define the step-by-step instructions for the model to follow through
  instructions: |
    Reformat the following botanical text EXACTLY into JSON according to the provided SCHEMA.

    - The output must be a single VALID JSON OBJECT with no surrounding text, explanations, markdown, or formatting.
    - DO NOT GENERATE ANYTHING beyond the required JSON structure.
    - **ALL KEYS MUST BE QUOTED PROPERLY**.
    - NO TRAILING COMMAS should be present.
    - Extract ONLY the text in the providede text; do not modify, paraphrase, infer or assume missing details.
    - Escape all special characters properly: `[` → `\[`, `]` → `\]`, `.` → `\.` if part of abbreviation or formatting.
    - When extracting text like dates, locations, or scientific references, maintain the exact format from the source without attempting to standardize or reformat.
    Output must strictly match this schema:
  # rules define the key-value rules for each expected key in the output json dict
  # rules:
  #   familyName: >
  #     The scientific family name in uppercase. If not available, use "N/A". Might include Tribe or Series with roman indexes
  #   species: >
  #     A list of dictionaries for each species under the family. Each dictionary should include:
  #     - speciesName: The full scientific name as written in the text. Keep the index number infront of the family name.
  #     - folders: A list of dictionaries denoted by small letter followed by a dot. Example (a. <text>, b. <text>, c. <text>), each containing:
  #          - description: A description of the folder contents. For description fields that contain citations or quotes, ensure proper escaping of all contained quotation marks.
  # schema defines the output json structure
  schema: default

  Examples: 
    - input: |
        RANUNCULACEAE

        .
        1. Aconitum Napellus, L.
        a. A portion of the plant in flower.
        Hohneck, Vosges, 13 Aug., 1855. Pic de Sancy, Auvergne,
        Sept., 1858.
        b. Plant in flower, with root attached.
        2. Aconitum Lycocotonum, L.
        a. Plant in flower, with root attached.
        Hohneck, Vosges, 13 Aug., 1855.
        3. Actaea spicata, L.
        a. Leafy stem with flowers and detached fruit. Cultivated at Clapham Common, 1867.
        b. Two leafy stems with fruit, and detached fruit.
        (1) Hohneck, Vosges, 13 Aug., 1855. (2) Auvergne, Sept.,
        1855.

    - output: |
        {
        "family_name": "RANUNCULACEAE",
        "species": [
            {
            "species_name": "1\\. Aconitum Napellus, L\\.",
            "number_of_folders": 2,
            "number_of_sheets": 0,
            "folders_and_sheets": [
                {
                "description": "a. A portion of the plant in flower. Hohneck, Vosges, 13 Aug\\., 1855. Pic de Sancy, Auvergne, Sept\\., 1858."
                },
                {
                "description": "b. Plant in flower, with root attached."
                }
            ]
            },
            {
            "species_name": "2\\. Aconitum Lycocotonum, L\\.",
            "number_of_folders": 1,
            "number_of_sheets": 0,
            "folders_and_sheets": [
                {
                "description": "a. Plant in flower, with root attached. Hohneck, Vosges, 13 Aug\\., 1855."
                }
            ]
            },
            {
            "species_name": "3\\. Actaea spicata, L\\.",
            "number_of_folders": 2,
            "number_of_sheets": 0,
            "folders_and_sheets": [
                {
                "description": "a. Leafy stem with flowers and detached fruit. Cultivated at Clapham Common, 1867."
                },
                {
                "description": "b. Two leafy stems with fruit, and detached fruit. (1) Hohneck, Vosges, 13 Aug\\., 1855. (2) Auvergne, Sept\\., 1855."
                }
            ]
            }
        ]
        }
    - input: |
        GUTTIFERAE

        .
        [52. Garcinia Hanburyi, Hook.f.] Garcinia Morella, Desrousse var. pedicellata.
        a. Leaves.
        Singapore, D'Almeida. With 6 drawings attached, including a sketch of the tree, leaves, flowers, and dissections of the flower and fruit.
        [These drawings formed the basis of the illustrations published in the Trans. Linn. Soc., 1864, vol. xxiv. tab. 50a, p. 487. The plant was subsequently raised to the rank of a species by Sir J. D. Hooker, under the name of G Hanburyi, Hook.f. See Journ. Lin. Soc., vol. xiv., p. 485, 1875. Bentl. and Trim. Med. Pl., tab. 33. Hanbury 'Science Papers,' p. 326-333.]

    - output: |
        {
        "family_name": "GUTTIFERAE",
        "species": [
            {
            "species_name": "\\[52\\. Garcinia Hanburyi, Hook\\.f\\.\\] Garcinia Morella, Desrousse var\\. pedicellata.",
            "number_of_folders": 1,
            "number_of_sheets": 0,
            "folders_and_sheets": [
                {
                "description": "a. Leaves. Singapore, D'Almeida. With 6 drawings attached, including a sketch of the tree, leaves, flowers, and dissections of the flower and fruit. \\[These drawings formed the basis of the illustrations published in the Trans\\. Linn\\. Soc\\., 1864, vol\\. xxiv\\., tab\\. 50a, p\\. 487. The plant was subsequently raised to the rank of a species by Sir J\\. D\\. Hooker, under the name of G Hanburyi, Hook\\.f\\. See Journ\\. Lin\\. Soc\\., vol\\. xiv\\., p\\. 485, 1875. Bentl\\. and Trim\\. Med\\. Pl\\., tab\\. 33. Hanbury 'Science Papers,' p\\. 326-333.\\]"
                }
            ]
            }
        ]
        }  




# user defines the user input. This can contain more than one prompt. 
# Different prompts will be passed to the model as individual inputs

user:

  # the prompt defines the user's prompt to the model
  text: | 
   Extract the botanical information from the provided text and format it into JSON according to the schema. 
   Ensure that all special characters are escaped properly and that the output is a single valid JSON object with no additional text or formatting.
  
   Text to extract from:
   \n\n{extracted_text}\n\n
    
