
EnvironmentNameNotFound: Could not find conda environment: lcat-step
You can list all discoverable environments with `conda info --envs`.


`Qwen2VLRotaryEmbedding` can now be fully parameterized by passing the model config through the `config` argument. All other arguments will be removed in v4.46
Setting OS envrionmnet variables
GPU Status: True
>>> Starting...
Namespace(images='/home/ikarunak/scratch/private/LightfootCatalogue/images', prompt='/home/ikarunak/scratch/private/LightfootCatalogue/prompts/ost_prompt.yaml', savefilename='lightfootcat_full', temp_text=None, max_tokens=100000, max_chunk_size=3000, save_path='/home/ikarunak/scratch/private/LightfootCatalogue/outputs/lightfootcat/', batch=1, crop=True, debug=False)
>>> Loading Images...
>>> Loading Model...
Loading checkpoint shards:   0%|          | 0/5 [00:00<?, ?it/s]Loading checkpoint shards:  20%|██        | 1/5 [00:05<00:20,  5.23s/it]Loading checkpoint shards:  40%|████      | 2/5 [00:10<00:15,  5.26s/it]Loading checkpoint shards:  60%|██████    | 3/5 [00:15<00:10,  5.11s/it]Loading checkpoint shards:  80%|████████  | 4/5 [00:20<00:04,  4.91s/it]Loading checkpoint shards: 100%|██████████| 5/5 [00:21<00:00,  3.63s/it]Loading checkpoint shards: 100%|██████████| 5/5 [00:21<00:00,  4.28s/it]
Model: qwen_model | Batch Size: 1, Max Tokens: 100000, Temperature: 1
lightfootcat_full
{'temp.txt', 'lightfootcat_full_errors.txt', 'lightfootcat_full.csv', 'two_images.csv', 'lightfootcat_full.json', 'two_images.json'}
lightfootcat_full_0
Extracting Text from Images
Processing Batches:   0%|          | 0/86 [00:00<?, ?batch/s]Processing Batches:   1%|          | 1/86 [00:57<1:20:53, 57.10s/batch]Processing Batches:   2%|▏         | 2/86 [01:59<1:23:56, 59.96s/batch]Processing Batches:   3%|▎         | 3/86 [03:04<1:26:30, 62.54s/batch]Processing Batches:   5%|▍         | 4/86 [03:45<1:13:34, 53.84s/batch]Processing Batches:   6%|▌         | 5/86 [04:49<1:17:35, 57.47s/batch]Processing Batches:   7%|▋         | 6/86 [06:03<1:24:27, 63.34s/batch]Processing Batches:   8%|▊         | 7/86 [07:10<1:24:59, 64.56s/batch]Processing Batches:   9%|▉         | 8/86 [07:52<1:14:35, 57.38s/batch]Processing Batches:  10%|█         | 9/86 [08:58<1:16:45, 59.82s/batch]Processing Batches:  12%|█▏        | 10/86 [10:03<1:17:47, 61.41s/batch]Processing Batches:  13%|█▎        | 11/86 [11:06<1:17:29, 62.00s/batch]Processing Batches:  14%|█▍        | 12/86 [12:11<1:17:35, 62.92s/batch]Processing Batches:  15%|█▌        | 13/86 [13:14<1:16:45, 63.09s/batch]Processing Batches:  16%|█▋        | 14/86 [14:19<1:16:05, 63.41s/batch]Processing Batches:  17%|█▋        | 15/86 [15:25<1:16:07, 64.33s/batch]Processing Batches:  19%|█▊        | 16/86 [16:36<1:17:16, 66.24s/batch]Processing Batches:  20%|█▉        | 17/86 [17:39<1:15:16, 65.46s/batch]Processing Batches:  21%|██        | 18/86 [18:44<1:14:05, 65.38s/batch]Processing Batches:  22%|██▏       | 19/86 [19:50<1:12:55, 65.30s/batch]Processing Batches:  23%|██▎       | 20/86 [20:58<1:12:59, 66.35s/batch]Processing Batches:  24%|██▍       | 21/86 [21:59<1:09:52, 64.49s/batch]Processing Batches:  26%|██▌       | 22/86 [23:10<1:11:09, 66.72s/batch]Processing Batches:  27%|██▋       | 23/86 [24:19<1:10:33, 67.20s/batch]Processing Batches:  28%|██▊       | 24/86 [25:22<1:08:14, 66.05s/batch]Processing Batches:  29%|██▉       | 25/86 [26:20<1:04:47, 63.73s/batch]Processing Batches:  30%|███       | 26/86 [27:32<1:05:59, 66.00s/batch]Processing Batches:  31%|███▏      | 27/86 [28:34<1:03:44, 64.82s/batch]Processing Batches:  33%|███▎      | 28/86 [29:41<1:03:28, 65.67s/batch]Processing Batches:  34%|███▎      | 29/86 [30:19<54:19, 57.19s/batch]  Processing Batches:  35%|███▍      | 30/86 [30:59<48:38, 52.11s/batch]Processing Batches:  36%|███▌      | 31/86 [32:06<51:54, 56.63s/batch]Processing Batches:  37%|███▋      | 32/86 [33:18<55:04, 61.19s/batch]Processing Batches:  38%|███▊      | 33/86 [34:26<55:46, 63.15s/batch]Processing Batches:  40%|███▉      | 34/86 [35:35<56:15, 64.91s/batch]Processing Batches:  41%|████      | 35/86 [36:35<54:04, 63.61s/batch]Processing Batches:  42%|████▏     | 36/86 [37:38<52:49, 63.39s/batch]Processing Batches:  43%|████▎     | 37/86 [38:44<52:13, 63.96s/batch]Processing Batches:  44%|████▍     | 38/86 [39:45<50:32, 63.17s/batch]Processing Batches:  45%|████▌     | 39/86 [40:52<50:25, 64.38s/batch]Processing Batches:  47%|████▋     | 40/86 [42:03<50:49, 66.29s/batch]Processing Batches:  48%|████▊     | 41/86 [43:01<47:51, 63.81s/batch]Processing Batches:  49%|████▉     | 42/86 [44:13<48:35, 66.26s/batch]Processing Batches:  50%|█████     | 43/86 [45:27<49:04, 68.48s/batch]Processing Batches:  51%|█████     | 44/86 [46:38<48:27, 69.22s/batch]Processing Batches:  52%|█████▏    | 45/86 [47:41<46:05, 67.46s/batch]Processing Batches:  53%|█████▎    | 46/86 [48:47<44:40, 67.02s/batch]Processing Batches:  55%|█████▍    | 47/86 [49:28<38:32, 59.30s/batch]Processing Batches:  56%|█████▌    | 48/86 [50:41<40:07, 63.36s/batch]Processing Batches:  57%|█████▋    | 49/86 [51:43<38:44, 62.82s/batch]Processing Batches:  58%|█████▊    | 50/86 [52:49<38:16, 63.78s/batch]Processing Batches:  59%|█████▉    | 51/86 [53:43<35:32, 60.94s/batch]Processing Batches:  60%|██████    | 52/86 [54:57<36:42, 64.79s/batch]Processing Batches:  62%|██████▏   | 53/86 [55:59<35:09, 63.92s/batch]Processing Batches:  63%|██████▎   | 54/86 [57:06<34:37, 64.91s/batch]Processing Batches:  64%|██████▍   | 55/86 [58:15<34:16, 66.33s/batch]Processing Batches:  65%|██████▌   | 56/86 [59:03<30:21, 60.70s/batch]Processing Batches:  66%|██████▋   | 57/86 [1:00:17<31:15, 64.68s/batch]Processing Batches:  67%|██████▋   | 58/86 [1:01:25<30:36, 65.58s/batch]Processing Batches:  69%|██████▊   | 59/86 [1:02:37<30:22, 67.50s/batch]Processing Batches:  70%|██████▉   | 60/86 [1:03:49<29:55, 69.07s/batch]Processing Batches:  71%|███████   | 61/86 [1:05:05<29:36, 71.04s/batch]Processing Batches:  72%|███████▏  | 62/86 [1:06:17<28:31, 71.30s/batch]Processing Batches:  73%|███████▎  | 63/86 [1:07:34<27:58, 72.97s/batch]Processing Batches:  74%|███████▍  | 64/86 [1:08:45<26:36, 72.58s/batch]Processing Batches:  76%|███████▌  | 65/86 [1:09:54<25:01, 71.50s/batch]Processing Batches:  77%|███████▋  | 66/86 [1:11:11<24:23, 73.16s/batch]Processing Batches:  78%|███████▊  | 67/86 [1:12:23<23:03, 72.81s/batch]Processing Batches:  79%|███████▉  | 68/86 [1:13:24<20:46, 69.27s/batch]Processing Batches:  80%|████████  | 69/86 [1:14:38<20:01, 70.67s/batch]Processing Batches:  81%|████████▏ | 70/86 [1:15:46<18:37, 69.83s/batch]Processing Batches:  83%|████████▎ | 71/86 [1:16:42<16:24, 65.64s/batch]Processing Batches:  84%|████████▎ | 72/86 [1:17:58<16:01, 68.66s/batch]Processing Batches:  85%|████████▍ | 73/86 [1:19:07<14:52, 68.67s/batch]Processing Batches:  86%|████████▌ | 74/86 [1:20:18<13:54, 69.52s/batch]Processing Batches:  87%|████████▋ | 75/86 [1:21:27<12:42, 69.30s/batch]Processing Batches:  88%|████████▊ | 76/86 [1:22:38<11:37, 69.80s/batch]Processing Batches:  90%|████████▉ | 77/86 [1:23:41<10:11, 67.97s/batch]Processing Batches:  91%|█████████ | 78/86 [1:24:23<08:00, 60.12s/batch]Processing Batches:  92%|█████████▏| 79/86 [1:25:32<07:19, 62.77s/batch]Processing Batches:  93%|█████████▎| 80/86 [1:26:46<06:36, 66.14s/batch]Processing Batches:  94%|█████████▍| 81/86 [1:27:54<05:33, 66.69s/batch]Processing Batches:  95%|█████████▌| 82/86 [1:28:54<04:18, 64.64s/batch]Processing Batches:  97%|█████████▋| 83/86 [1:29:24<02:42, 54.31s/batch]Processing Batches:  98%|█████████▊| 84/86 [1:30:31<01:56, 58.12s/batch]Processing Batches:  99%|█████████▉| 85/86 [1:31:19<00:55, 55.07s/batch]This is a friendly reminder - the current text generation call will exceed the model's predefined maximum length (32768). Depending on the model, you may observe exceptions, performance degradation, or nothing at all.
Processing Batches: 100%|██████████| 86/86 [2:13:16<00:00, 793.53s/batch]Processing Batches: 100%|██████████| 86/86 [2:13:16<00:00, 92.98s/batch] 
Converting extracted text into Text Blocks
Organising text into JSON blocks
Processing Families in Dicotyledones:   0%|          | 0/128 [00:00<?, ?family/s]Processing Families in Dicotyledones:   1%|          | 1/128 [00:09<19:09,  9.05s/family]Processing Families in Dicotyledones:   2%|▏         | 2/128 [00:18<19:24,  9.24s/family]Processing Families in Dicotyledones:   2%|▏         | 3/128 [00:22<14:10,  6.80s/family]Processing Families in Dicotyledones:   3%|▎         | 4/128 [00:28<13:08,  6.36s/family]Processing Families in Dicotyledones:   4%|▍         | 5/128 [00:32<11:29,  5.61s/family]Processing Families in Dicotyledones:   5%|▍         | 6/128 [00:38<12:08,  5.97s/family]Processing Families in Dicotyledones:   5%|▌         | 7/128 [01:33<44:19, 21.98s/family]Processing Families in Dicotyledones:   6%|▋         | 8/128 [01:52<41:32, 20.77s/family]Processing Families in Dicotyledones:   7%|▋         | 9/128 [03:04<1:13:06, 36.86s/family]Processing Families in Dicotyledones:   8%|▊         | 10/128 [04:31<1:43:04, 52.41s/family]Processing Families in Dicotyledones:   9%|▊         | 11/128 [05:33<1:47:46, 55.27s/family]Processing Families in Dicotyledones:   9%|▉         | 12/128 [06:28<1:46:57, 55.33s/family]Processing Families in Dicotyledones:  10%|█         | 13/128 [06:32<1:16:14, 39.78s/family]Processing Families in Dicotyledones:  11%|█         | 14/128 [06:42<58:25, 30.75s/family]  Processing Families in Dicotyledones:  12%|█▏        | 15/128 [08:17<1:34:15, 50.05s/family]Processing Families in Dicotyledones:  12%|█▎        | 16/128 [09:27<1:44:26, 55.95s/family]Processing Families in Dicotyledones:  13%|█▎        | 17/128 [09:53<1:26:53, 46.97s/family]Processing Families in Dicotyledones:  14%|█▍        | 18/128 [11:40<1:59:12, 65.02s/family]Processing Families in Dicotyledones:  15%|█▍        | 19/128 [13:21<2:18:00, 75.97s/family]Processing Families in Dicotyledones:  16%|█▌        | 20/128 [14:46<2:21:32, 78.63s/family]Processing Families in Dicotyledones:  16%|█▋        | 21/128 [16:22<2:29:35, 83.88s/family]Processing Families in Dicotyledones:  17%|█▋        | 22/128 [18:13<2:42:30, 91.98s/family]Processing Families in Dicotyledones:  18%|█▊        | 23/128 [18:32<2:02:30, 70.01s/family]Processing Families in Dicotyledones:  19%|█▉        | 24/128 [19:30<1:55:09, 66.43s/family]Processing Families in Dicotyledones:  20%|█▉        | 25/128 [21:01<2:06:43, 73.82s/family]Processing Families in Dicotyledones:  20%|██        | 26/128 [22:14<2:05:11, 73.64s/family]Processing Families in Dicotyledones:  21%|██        | 27/128 [23:52<2:16:11, 80.90s/family]Processing Families in Dicotyledones:  22%|██▏       | 28/128 [25:10<2:13:27, 80.08s/family]Processing Families in Dicotyledones:  23%|██▎       | 29/128 [25:31<1:42:43, 62.26s/family]Processing Families in Dicotyledones:  23%|██▎       | 30/128 [25:35<1:13:10, 44.80s/family]Processing Families in Dicotyledones:  24%|██▍       | 31/128 [25:45<55:50, 34.54s/family]  Processing Families in Dicotyledones:  25%|██▌       | 32/128 [25:56<43:51, 27.41s/family]Processing Families in Dicotyledones:  26%|██▌       | 33/128 [26:02<33:18, 21.04s/family]Processing Families in Dicotyledones:  27%|██▋       | 34/128 [26:09<25:59, 16.59s/family]Processing Families in Dicotyledones:  27%|██▋       | 35/128 [26:50<37:18, 24.07s/family]Processing Families in Dicotyledones:  28%|██▊       | 36/128 [28:19<1:06:33, 43.41s/family]Processing Families in Dicotyledones:  29%|██▉       | 37/128 [28:28<50:10, 33.09s/family]  Processing Families in Dicotyledones:  30%|██▉       | 38/128 [28:58<48:32, 32.36s/family]Processing Families in Dicotyledones:  30%|███       | 39/128 [30:14<1:07:06, 45.25s/family]Processing Families in Dicotyledones:  31%|███▏      | 40/128 [30:18<48:23, 32.99s/family]  Processing Families in Dicotyledones:  32%|███▏      | 41/128 [30:24<35:58, 24.81s/family]Processing Families in Dicotyledones:  33%|███▎      | 42/128 [30:31<27:54, 19.47s/family]Processing Families in Dicotyledones:  34%|███▎      | 43/128 [30:53<28:52, 20.38s/family]Processing Families in Dicotyledones:  34%|███▍      | 44/128 [32:34<1:02:23, 44.56s/family]Processing Families in Dicotyledones:  35%|███▌      | 45/128 [33:35<1:08:31, 49.54s/family]Processing Families in Dicotyledones:  36%|███▌      | 46/128 [34:10<1:01:44, 45.18s/family]Processing Families in Dicotyledones:  37%|███▋      | 47/128 [35:46<1:21:31, 60.39s/family]Processing Families in Dicotyledones:  38%|███▊      | 48/128 [6:13:58<136:13:13, 6129.92s/family]Processing Families in Dicotyledones:  38%|███▊      | 49/128 [6:14:37<94:25:06, 4302.62s/family] Processing Families in Dicotyledones:  39%|███▉      | 50/128 [6:14:58<65:23:19, 3017.95s/family]Processing Families in Dicotyledones:  40%|███▉      | 51/128 [6:15:46<45:29:43, 2127.06s/family]Processing Families in Dicotyledones:  41%|████      | 52/128 [6:15:57<31:30:04, 1492.17s/family]Processing Families in Dicotyledones:  41%|████▏     | 53/128 [6:16:14<21:51:54, 1049.53s/family]Processing Families in Dicotyledones:  42%|████▏     | 54/128 [6:16:17<15:07:26, 735.76s/family] Processing Families in Dicotyledones:  43%|████▎     | 55/128 [6:16:21<10:28:06, 516.25s/family]Processing Families in Dicotyledones:  44%|████▍     | 56/128 [6:17:18<7:33:56, 378.29s/family] Processing Families in Dicotyledones:  45%|████▍     | 57/128 [6:17:22<5:14:45, 265.99s/family]Processing Families in Dicotyledones:  45%|████▌     | 58/128 [6:18:06<3:52:55, 199.65s/family]Processing Families in Dicotyledones:  46%|████▌     | 59/128 [6:18:11<2:42:23, 141.21s/family]Processing Families in Dicotyledones:  47%|████▋     | 60/128 [6:19:02<2:09:20, 114.12s/family]Processing Families in Dicotyledones:  48%|████▊     | 61/128 [6:19:25<1:36:58, 86.85s/family] Processing Families in Dicotyledones:  48%|████▊     | 62/128 [6:19:32<1:08:55, 62.66s/family]Processing Families in Dicotyledones:  49%|████▉     | 63/128 [6:20:47<1:12:08, 66.59s/family]Processing Families in Dicotyledones:  50%|█████     | 64/128 [6:21:16<58:59, 55.31s/family]  Processing Families in Dicotyledones:  51%|█████     | 65/128 [6:21:56<53:06, 50.58s/family]Processing Families in Dicotyledones:  52%|█████▏    | 66/128 [6:23:51<1:12:19, 69.99s/family]Processing Families in Dicotyledones:  52%|█████▏    | 67/128 [6:24:04<53:37, 52.75s/family]  Processing Families in Dicotyledones:  53%|█████▎    | 68/128 [6:25:35<1:04:26, 64.44s/family]Processing Families in Dicotyledones:  54%|█████▍    | 69/128 [6:27:00<1:09:09, 70.34s/family]Processing Families in Dicotyledones:  55%|█████▍    | 70/128 [6:27:17<52:32, 54.35s/family]  Processing Families in Dicotyledones:  55%|█████▌    | 71/128 [12:05:54<97:06:43, 6133.39s/family]Processing Families in Dicotyledones:  56%|█████▋    | 72/128 [12:07:08<67:07:41, 4315.39s/family]Processing Families in Dicotyledones:  57%|█████▋    | 73/128 [12:07:36<46:16:47, 3029.23s/family]Processing Families in Dicotyledones:  58%|█████▊    | 74/128 [12:09:11<32:14:09, 2149.06s/family]Processing Families in Dicotyledones:  59%|█████▊    | 75/128 [12:09:38<22:16:00, 1512.46s/family]Processing Families in Dicotyledones:  59%|█████▉    | 76/128 [12:09:42<15:18:36, 1059.93s/family]Processing Families in Dicotyledones:  60%|██████    | 77/128 [12:09:48<10:32:00, 743.55s/family] Processing Families in Dicotyledones:  61%|██████    | 78/128 [12:10:15<7:20:39, 528.79s/family] Processing Families in Dicotyledones:  62%|██████▏   | 79/128 [12:10:26<5:04:52, 373.31s/family]Processing Families in Dicotyledones:  62%|██████▎   | 80/128 [12:11:56<3:50:38, 288.29s/family]Processing Families in Dicotyledones:  63%|██████▎   | 81/128 [12:12:52<2:51:18, 218.70s/family]Processing Families in Dicotyledones:  64%|██████▍   | 82/128 [12:13:26<2:05:08, 163.24s/family]Processing Families in Dicotyledones:  65%|██████▍   | 83/128 [12:13:30<1:26:37, 115.50s/family]Processing Families in Dicotyledones:  66%|██████▌   | 84/128 [12:13:34<1:00:11, 82.07s/family] Processing Families in Dicotyledones:  66%|██████▋   | 85/128 [12:13:44<43:10, 60.25s/family]  Processing Families in Dicotyledones:  67%|██████▋   | 86/128 [12:15:31<52:07, 74.47s/family]Processing Families in Dicotyledones:  68%|██████▊   | 87/128 [12:15:43<37:58, 55.58s/family]Processing Families in Dicotyledones:  69%|██████▉   | 88/128 [12:15:54<28:13, 42.33s/family]Processing Families in Dicotyledones:  70%|██████▉   | 89/128 [12:15:58<20:02, 30.83s/family]Processing Families in Dicotyledones:  70%|███████   | 90/128 [12:16:25<18:44, 29.60s/family]Processing Families in Dicotyledones:  71%|███████   | 91/128 [12:16:34<14:29, 23.50s/family]Processing Families in Dicotyledones:  72%|███████▏  | 92/128 [12:16:52<13:07, 21.86s/family]Processing Families in Dicotyledones:  73%|███████▎  | 93/128 [17:59:20<60:04:49, 6179.71s/family]Processing Families in Dicotyledones:  73%|███████▎  | 94/128 [17:59:25<40:52:06, 4327.26s/family]