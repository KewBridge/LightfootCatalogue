Activated Environment
Downloading shards:   0%|          | 0/5 [00:00<?, ?it/s]Downloading shards:  20%|██        | 1/5 [00:00<00:00,  9.53it/s]Downloading shards:  40%|████      | 2/5 [00:00<00:00,  7.80it/s]Downloading shards:  60%|██████    | 3/5 [00:00<00:00,  8.24it/s]Downloading shards:  80%|████████  | 4/5 [00:00<00:00,  8.54it/s]Downloading shards: 100%|██████████| 5/5 [00:00<00:00,  8.74it/s]Downloading shards: 100%|██████████| 5/5 [00:00<00:00,  8.56it/s]
/mnt/apps/users/ikarunak/conda/envs/lcat-step/lib/python3.11/site-packages/transformers/generation/configuration_utils.py:628: UserWarning: `do_sample` is set to `False`. However, `temperature` is set to `0.6` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `temperature`. This was detected when initializing the generation config instance, which means the corresponding file may hold incorrect parameterization and should be fixed.
  warnings.warn(
/mnt/apps/users/ikarunak/conda/envs/lcat-step/lib/python3.11/site-packages/transformers/generation/configuration_utils.py:628: UserWarning: `do_sample` is set to `False`. However, `temperature` is set to `0.6` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `temperature`.
  warnings.warn(
`Qwen2VLRotaryEmbedding` can now be fully parameterized by passing the model config through the `config` argument. All other arguments will be removed in v4.46
Loading checkpoint shards:   0%|          | 0/5 [00:00<?, ?it/s]Loading checkpoint shards:  20%|██        | 1/5 [00:05<00:23,  5.85s/it]Loading checkpoint shards:  40%|████      | 2/5 [00:11<00:16,  5.52s/it]Loading checkpoint shards:  60%|██████    | 3/5 [00:16<00:10,  5.23s/it]Loading checkpoint shards:  80%|████████  | 4/5 [00:21<00:05,  5.26s/it]Loading checkpoint shards: 100%|██████████| 5/5 [00:23<00:00,  4.00s/it]Loading checkpoint shards: 100%|██████████| 5/5 [00:23<00:00,  4.62s/it]
Model: qwen_model | Batch Size: 1, Max Tokens: 100000, Temperature: 0.6
Processing Batches:   0%|          | 0/84 [00:00<?, ?batch/s]Processing Batches:   1%|          | 1/84 [00:57<1:19:21, 57.37s/batch]Processing Batches:   2%|▏         | 2/84 [01:59<1:22:14, 60.18s/batch]Processing Batches:   4%|▎         | 3/84 [03:05<1:24:40, 62.73s/batch]Processing Batches:   5%|▍         | 4/84 [03:45<1:12:01, 54.01s/batch]Processing Batches:   6%|▌         | 5/84 [04:49<1:15:53, 57.64s/batch]Processing Batches:   7%|▋         | 6/84 [06:04<1:22:31, 63.48s/batch]Processing Batches:   8%|▊         | 7/84 [07:11<1:23:00, 64.69s/batch]Processing Batches:  10%|▉         | 8/84 [07:54<1:12:49, 57.49s/batch]Processing Batches:  11%|█         | 9/84 [08:59<1:14:53, 59.92s/batch]Processing Batches:  12%|█▏        | 10/84 [10:04<1:15:50, 61.49s/batch]Processing Batches:  13%|█▎        | 11/84 [11:07<1:15:30, 62.06s/batch]Processing Batches:  14%|█▍        | 12/84 [12:12<1:15:35, 63.00s/batch]Processing Batches:  15%|█▌        | 13/84 [13:16<1:14:44, 63.16s/batch]Processing Batches:  17%|█▋        | 14/84 [14:20<1:14:06, 63.52s/batch]Processing Batches:  18%|█▊        | 15/84 [15:27<1:14:05, 64.43s/batch]Processing Batches:  19%|█▉        | 16/84 [16:38<1:15:11, 66.34s/batch]Processing Batches:  20%|██        | 17/84 [17:41<1:13:12, 65.57s/batch]Processing Batches:  21%|██▏       | 18/84 [18:47<1:12:02, 65.49s/batch]Processing Batches:  23%|██▎       | 19/84 [19:52<1:10:51, 65.40s/batch]Processing Batches:  24%|██▍       | 20/84 [21:01<1:10:52, 66.44s/batch]Processing Batches:  25%|██▌       | 21/84 [22:01<1:07:47, 64.56s/batch]Processing Batches:  26%|██▌       | 22/84 [23:13<1:09:02, 66.81s/batch]Processing Batches:  27%|██▋       | 23/84 [24:21<1:08:23, 67.27s/batch]Processing Batches:  29%|██▊       | 24/84 [25:25<1:06:06, 66.11s/batch]Processing Batches:  30%|██▉       | 25/84 [26:23<1:02:43, 63.79s/batch]Processing Batches:  31%|███       | 26/84 [27:34<1:03:53, 66.09s/batch]Processing Batches:  32%|███▏      | 27/84 [28:37<1:01:38, 64.89s/batch]Processing Batches:  33%|███▎      | 28/84 [29:44<1:01:22, 65.75s/batch]Processing Batches:  35%|███▍      | 29/84 [30:22<52:28, 57.25s/batch]  Processing Batches:  36%|███▌      | 30/84 [31:02<46:56, 52.16s/batch]Processing Batches:  37%|███▋      | 31/84 [32:09<50:04, 56.70s/batch]Processing Batches:  38%|███▊      | 32/84 [33:21<53:05, 61.26s/batch]Processing Batches:  39%|███▉      | 33/84 [34:29<53:44, 63.23s/batch]Processing Batches:  40%|████      | 34/84 [35:38<54:09, 64.98s/batch]Processing Batches:  42%|████▏     | 35/84 [36:39<52:00, 63.68s/batch]Processing Batches:  43%|████▎     | 36/84 [37:42<50:46, 63.46s/batch]Processing Batches:  44%|████▍     | 37/84 [38:47<50:09, 64.03s/batch]Processing Batches:  45%|████▌     | 38/84 [39:48<48:29, 63.25s/batch]Processing Batches:  46%|████▋     | 39/84 [40:56<48:20, 64.46s/batch]Processing Batches:  48%|████▊     | 40/84 [42:07<48:40, 66.37s/batch]Processing Batches:  49%|████▉     | 41/84 [43:04<45:44, 63.83s/batch]Processing Batches:  50%|█████     | 42/84 [44:16<46:23, 66.27s/batch]Processing Batches:  51%|█████     | 43/84 [45:30<46:48, 68.49s/batch]Processing Batches:  52%|█████▏    | 44/84 [46:41<46:08, 69.22s/batch]Processing Batches:  54%|█████▎    | 45/84 [47:44<43:51, 67.48s/batch]Processing Batches:  55%|█████▍    | 46/84 [48:50<42:26, 67.01s/batch]Processing Batches:  56%|█████▌    | 47/84 [49:32<36:33, 59.29s/batch]Processing Batches:  57%|█████▋    | 48/84 [50:44<38:00, 63.34s/batch]Processing Batches:  58%|█████▊    | 49/84 [51:46<36:37, 62.80s/batch]Processing Batches:  60%|█████▉    | 50/84 [52:52<36:07, 63.76s/batch]Processing Batches:  61%|██████    | 51/84 [53:46<33:29, 60.90s/batch]Processing Batches:  62%|██████▏   | 52/84 [55:00<34:32, 64.78s/batch]Processing Batches:  63%|██████▎   | 53/84 [56:02<33:01, 63.93s/batch]Processing Batches:  64%|██████▍   | 54/84 [57:09<32:28, 64.94s/batch]Processing Batches:  65%|██████▌   | 55/84 [58:19<32:04, 66.36s/batch]Processing Batches:  67%|██████▋   | 56/84 [59:07<28:20, 60.74s/batch]Processing Batches:  68%|██████▊   | 57/84 [1:00:21<29:07, 64.73s/batch]Processing Batches:  69%|██████▉   | 58/84 [1:01:28<28:26, 65.64s/batch]Processing Batches:  70%|███████   | 59/84 [1:02:40<28:09, 67.58s/batch]Processing Batches:  71%|███████▏  | 60/84 [1:03:53<27:39, 69.15s/batch]Processing Batches:  73%|███████▎  | 61/84 [1:05:09<27:15, 71.12s/batch]Processing Batches:  74%|███████▍  | 62/84 [1:06:21<26:10, 71.38s/batch]Processing Batches:  75%|███████▌  | 63/84 [1:07:38<25:34, 73.07s/batch]Processing Batches:  76%|███████▌  | 64/84 [1:08:50<24:13, 72.69s/batch]Processing Batches:  77%|███████▋  | 65/84 [1:09:59<22:40, 71.61s/batch]Processing Batches:  79%|███████▊  | 66/84 [1:11:16<21:58, 73.25s/batch]Processing Batches:  80%|███████▉  | 67/84 [1:12:28<20:39, 72.90s/batch]Processing Batches:  81%|████████  | 68/84 [1:13:29<18:29, 69.33s/batch]Processing Batches:  82%|████████▏ | 69/84 [1:14:43<17:41, 70.75s/batch]Processing Batches:  83%|████████▎ | 70/84 [1:15:51<16:18, 69.91s/batch]Processing Batches:  85%|████████▍ | 71/84 [1:16:47<14:14, 65.73s/batch]Processing Batches:  86%|████████▌ | 72/84 [1:18:03<13:44, 68.75s/batch]Processing Batches:  87%|████████▋ | 73/84 [1:19:12<12:36, 68.75s/batch]Processing Batches:  88%|████████▊ | 74/84 [1:20:23<11:36, 69.60s/batch]Processing Batches:  89%|████████▉ | 75/84 [1:21:32<10:24, 69.38s/batch]Processing Batches:  90%|█████████ | 76/84 [1:22:43<09:19, 69.88s/batch]Processing Batches:  92%|█████████▏| 77/84 [1:23:47<07:56, 68.04s/batch]Processing Batches:  93%|█████████▎| 78/84 [1:24:29<06:01, 60.20s/batch]Processing Batches:  94%|█████████▍| 79/84 [1:25:38<05:14, 62.83s/batch]Processing Batches:  95%|█████████▌| 80/84 [1:26:52<04:24, 66.20s/batch]Processing Batches:  96%|█████████▋| 81/84 [1:28:00<03:20, 66.75s/batch]Processing Batches:  98%|█████████▊| 82/84 [1:29:00<02:09, 64.71s/batch]Processing Batches:  99%|█████████▉| 83/84 [1:29:30<00:54, 54.35s/batch]Processing Batches: 100%|██████████| 84/84 [1:30:37<00:00, 58.18s/batch]Processing Batches: 100%|██████████| 84/84 [1:30:37<00:00, 64.73s/batch]
Traceback (most recent call last):
  File "/mnt/shared/scratch/ikarunak/private/LightfootCatalogue/run.py", line 76, in <module>
    main()
  File "/mnt/shared/scratch/ikarunak/private/LightfootCatalogue/run.py", line 71, in main
    _ = model(images, args.temp_text, save=True, save_file_name=args.savefilename)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/shared/scratch/ikarunak/private/LightfootCatalogue/lib/model/base_model.py", line 295, in __call__
    text_blocks = convertToTextBlocks(extracted_text, divisions=self.prompt.get_divisions(), max_chunk_size=max_chunk_size)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/shared/scratch/ikarunak/private/LightfootCatalogue/lib/utils/text_utils.py", line 141, in convertToTextBlocks
    splits[division] = split_family(division_text, max_chunk_size)
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/shared/scratch/ikarunak/private/LightfootCatalogue/lib/utils/text_utils.py", line 51, in split_family
    small_chunks = split_into_smaller_chunks(family, max_chunk_size)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/shared/scratch/ikarunak/private/LightfootCatalogue/lib/utils/text_utils.py", line 61, in split_into_smaller_chunks
    family_name, text_block = list(
    ^^^^^^^^^^^^^^^^^^^^^^^
ValueError: not enough values to unpack (expected 2, got 1)
